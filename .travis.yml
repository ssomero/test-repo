language: nodejs
nodejs:
- '8'
sudo: required
services:
- docker
branches:
  only:
  - development
before_install:
- nvm install node
script:
- docker-compose build --no-cache
- cd frontend && npm install && npm run build
- cp src/index.html dist/
- mv dist/ ../backend/src/
before_deploy:
- cd ../backend
deploy:
  provider: heroku
  skip_cleanup: true
  api_key:
    secure: CJkLGjCjv8lbqFo8bb73xF8ekUXRAtJMw008LwR+XsePoa8kXGAbgA7f6RwisU5iTviHp+ch3Q4MDNM1iwF5k1DxyLdWrjyNdUYUaVWp57ruRMoStf0HGrutpRd2yg4LwdcKwyff9RcWNiGY8+Du8Bc/yGP+8TgIzUJH3PJeCfOhIyPyRxGUEwrzbCd3tNBYon1wKH4NKR1R3h9UosUwzerd7DUMd1Z3VB/YphfTgGbCMCrg97akowAf3MsBX85xK9dryZdOgicu/VZZeQZHxxMoECwf5985SvbUXIinWu7QsZ3Fj2UY0gE2RpaiMChOLNQWITMr6/GURQ2WQP4PtG6IDXvZI3xbZaKz+rp35lViHCqmsBInfMJN9EukM3un/DtyZQieCRAu5jeQlkyxNrVTbl1rJbLoLevj5tyo+kUVkMG7wOPgO0cQE2tYTi+c68rAjuN6Js5L2k1R5mv2m3m7MmwWYql/3wiGV6X3cnzUZYFmUAf9lvEo9q6uBEqgNhy92nlq46WbSmIy6d42LFz88YfNlnDR4s+Ep70dI+qt4EhhoJ1K5/cCLPjetDlBT4pmclIxKBVzxT42xFI6lyG2hIwbMqZmIb64zQ1IX/1enL7B+075PGxtqLeJFKcSXfv1VPA/QO88pZwzdg448xyXvlLUUGfV4lHIpAe2CEU=
  on: development
  app: murmuring-anchorage-85311
